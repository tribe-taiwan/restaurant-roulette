<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWA Icon Generator - ç”²å´©å–”ç¾é£Ÿè¼ªç›¤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #ff4c00;
            text-align: center;
            margin-bottom: 30px;
        }
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .icon-item {
            text-align: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .icon-preview {
            margin: 10px 0;
        }
        .download-btn {
            background: #ff4c00;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .download-btn:hover {
            background: #e63900;
        }
        .instructions {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2196F3;
        }
        canvas {
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ½ï¸ ç”²å´©å–” PWA Icon Generator</h1>
        
        <div class="instructions">
            <h3>ğŸ“– ä½¿ç”¨èªªæ˜ï¼š</h3>
            <ol>
                <li>é»æ“Šã€ŒğŸ¨ ç”Ÿæˆæ‰€æœ‰åœ–æ¨™ã€æŒ‰éˆ•</li>
                <li>ç­‰å¾…æ‰€æœ‰åœ–æ¨™ç”Ÿæˆå®Œæˆ</li>
                <li>é»æ“Šã€ŒğŸ“¦ ä¸€éµä¸‹è¼‰å…¨éƒ¨ã€æˆ–ã€ŒğŸ—œï¸ ä¸‹è¼‰ZIPå£“ç¸®æª”ã€</li>
                <li>å°‡ä¸‹è¼‰çš„åœ–ç‰‡æ”¾å…¥ <code>assets/icons/</code> ç›®éŒ„</li>
            </ol>
            <p><strong>ğŸ“± iOSç”¨æˆ¶ï¼š</strong> é€™äº›åœ–æ¨™ç¢ºä¿ä½ çš„PWAåœ¨iPhoneä¸Šèƒ½æ­£ç¢ºé¡¯ç¤ºï¼ŒåŒ…æ‹¬ä¸»ç•«é¢åœ–æ¨™å’Œå•Ÿå‹•ç•«é¢ã€‚</p>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <button onclick="generateAllIcons()" style="background: #4f46e5; color: white; border: none; padding: 15px 30px; font-size: 18px; border-radius: 8px; cursor: pointer; margin-right: 10px;">
                ğŸ¨ ç”Ÿæˆæ‰€æœ‰åœ–æ¨™
            </button>
            <button id="downloadAllBtn" onclick="downloadAllIcons()" style="background: #ff4c00; color: white; border: none; padding: 15px 30px; font-size: 18px; border-radius: 8px; cursor: pointer; display: none; margin-right: 10px;">
                ğŸ“¦ ä¸€éµä¸‹è¼‰å…¨éƒ¨
            </button>
            <button id="downloadZipBtn" onclick="downloadAsZip()" style="background: #059669; color: white; border: none; padding: 15px 30px; font-size: 18px; border-radius: 8px; cursor: pointer; display: none;">
                ğŸ—œï¸ ä¸‹è¼‰ZIPå£“ç¸®æª”
            </button>
        </div>

        <div id="iconGrid" class="icon-grid"></div>
    </div>

    <script>
        // PWA æ‰€éœ€çš„æ‰€æœ‰åœ–æ¨™å°ºå¯¸
        const iconSizes = [
            { size: 16, name: 'icon-16x16.png', desc: 'Favicon å°åœ–æ¨™' },
            { size: 32, name: 'icon-32x32.png', desc: 'Favicon æ¨™æº–' },
            { size: 70, name: 'icon-70x70.png', desc: 'Windows Metro' },
            { size: 72, name: 'icon-72x72.png', desc: 'Android Chrome' },
            { size: 96, name: 'icon-96x96.png', desc: 'Android Chrome' },
            { size: 128, name: 'icon-128x128.png', desc: 'Android Chrome' },
            { size: 144, name: 'icon-144x144.png', desc: 'Windows Metro Tile' },
            { size: 150, name: 'icon-150x150.png', desc: 'Windows Metro' },
            { size: 152, name: 'icon-152x152.png', desc: 'iOS Safari' },
            { size: 180, name: 'icon-180x180.png', desc: 'iOS Safari (iPhone)' },
            { size: 192, name: 'icon-192x192.png', desc: 'Android Chrome (æ¨è–¦)' },
            { size: 310, name: 'icon-310x150.png', desc: 'Windows Wide Tile', width: 310, height: 150 },
            { size: 310, name: 'icon-310x310.png', desc: 'Windows Large Tile' },
            { size: 384, name: 'icon-384x384.png', desc: 'Android Chrome' },
            { size: 512, name: 'icon-512x512.png', desc: 'Android Chrome (æ¨è–¦)' },
            { size: 180, name: 'apple-touch-icon.png', desc: 'iOS é€šç”¨åœ–æ¨™' }
        ];

        // å­˜å„²ç”Ÿæˆçš„åœ–æ¨™blob
        let generatedIcons = new Map();

        function createIconSVG(size, isWide = false) {
            const width = isWide ? 310 : size;
            const height = isWide ? 150 : size;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) / 2;
            const innerRadius = radius * 0.75;
            
            return `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${width} ${height}" width="${width}" height="${height}">
                    <!-- èƒŒæ™¯åœ“åœˆæˆ–çŸ©å½¢ -->
                    ${isWide ? 
                        `<rect x="0" y="0" width="${width}" height="${height}" rx="20" fill="#ff4c00"/>` :
                        `<circle cx="${centerX}" cy="${centerY}" r="${radius}" fill="#ff4c00"/>`
                    }
                    
                    <!-- ç™½è‰²èƒŒæ™¯å€åŸŸ -->
                    ${isWide ? 
                        `<rect x="10" y="10" width="${width-20}" height="${height-20}" rx="15" fill="white"/>` :
                        `<circle cx="${centerX}" cy="${centerY}" r="${innerRadius}" fill="white"/>`
                    }
                    
                    ${size >= 72 ? `
                        <!-- é¤ç›¤ -->
                        <circle cx="${centerX}" cy="${centerY + radius * 0.1}" r="${radius * 0.45}" fill="none" stroke="#ff4c00" stroke-width="${Math.max(2, radius * 0.06)}"/>
                        
                        <!-- åˆ€å‰ -->
                        <g transform="translate(${centerX - radius * 0.25}, ${centerY - radius * 0.25})">
                            <rect x="0" y="0" width="${radius * 0.08}" height="${radius * 0.5}" fill="#4f46e5"/>
                            <rect x="${-radius * 0.08}" y="0" width="${radius * 0.06}" height="${radius * 0.15}" fill="#4f46e5"/>
                            <rect x="${radius * 0.08}" y="0" width="${radius * 0.06}" height="${radius * 0.15}" fill="#4f46e5"/>
                        </g>
                        
                        <g transform="translate(${centerX + radius * 0.25}, ${centerY - radius * 0.25})">
                            <rect x="0" y="0" width="${radius * 0.08}" height="${radius * 0.5}" fill="#4f46e5"/>
                            <path d="M ${-radius * 0.06} 0 L ${radius * 0.14} 0 L ${radius * 0.08} ${-radius * 0.12} L ${-radius * 0.06} ${-radius * 0.12} Z" fill="#4f46e5"/>
                        </g>
                        
                        <!-- æŒ‡é‡ -->
                        <g transform="translate(${centerX}, ${centerY}) rotate(45)">
                            <path d="M 0 ${-radius * 0.3} L ${radius * 0.06} ${-radius * 0.08} L 0 0 L ${-radius * 0.06} ${-radius * 0.08} Z" fill="#ff4c00"/>
                        </g>
                        
                        <!-- ä¸­å¿ƒé» -->
                        <circle cx="${centerX}" cy="${centerY}" r="${radius * 0.05}" fill="#4f46e5"/>
                    ` : `
                        <!-- ç°¡åŒ–ç‰ˆæœ¬ (å°å°ºå¯¸) -->
                        <circle cx="${centerX}" cy="${centerY}" r="${radius * 0.3}" fill="#4f46e5"/>
                        <text x="${centerX}" y="${centerY + radius * 0.1}" font-family="Arial, sans-serif" font-size="${radius * 0.4}" fill="white" text-anchor="middle">ğŸ½</text>
                    `}
                    
                    ${isWide && size >= 150 ? `
                        <!-- Wide tile æ–‡å­— -->
                        <text x="${centerX}" y="${centerY + 20}" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#4f46e5" text-anchor="middle">ç”²å´©å–”ç¾é£Ÿè¼ªç›¤</text>
                    ` : ''}
                </svg>
            `;
        }

        function generateAllIcons() {
            const iconGrid = document.getElementById('iconGrid');
            iconGrid.innerHTML = '';

            iconSizes.forEach(iconDef => {
                const isWide = iconDef.name.includes('310x150');
                const width = iconDef.width || iconDef.size;
                const height = iconDef.height || iconDef.size;
                
                // å‰µå»ºå®¹å™¨
                const iconItem = document.createElement('div');
                iconItem.className = 'icon-item';
                
                // å‰µå»ºSVG
                const svgContent = createIconSVG(iconDef.size, isWide);
                
                // å‰µå»ºcanvasä¸¦è½‰æ›ç‚ºPNG
                const canvas = document.createElement('canvas');
                canvas.width = width;
                canvas.height = height;
                canvas.style.width = Math.min(width, 100) + 'px';
                canvas.style.height = Math.min(height, 100) + 'px';
                
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // å‰µå»ºä¸‹è¼‰é€£çµ
                    canvas.toBlob(function(blob) {
                        const url = URL.createObjectURL(blob);
                        
                        // å­˜å„²åˆ°å…¨åŸŸMapä¸­ï¼Œä¾›æ‰¹é‡ä¸‹è¼‰ä½¿ç”¨
                        generatedIcons.set(iconDef.name, { blob, url });
                        
                        const downloadBtn = iconItem.querySelector('.download-btn');
                        downloadBtn.onclick = function() {
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = iconDef.name;
                            a.click();
                        };
                        
                        // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰åœ–æ¨™éƒ½å·²ç”Ÿæˆ
                        if (generatedIcons.size === iconSizes.length) {
                            document.getElementById('downloadAllBtn').style.display = 'inline-block';
                            document.getElementById('downloadZipBtn').style.display = 'inline-block';
                            console.log('ğŸ‰ æ‰€æœ‰åœ–æ¨™å·²ç”Ÿæˆå®Œæˆï¼');
                        }
                    }, 'image/png');
                };
                
                img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgContent)));
                
                iconItem.innerHTML = `
                    <h4>${iconDef.name}</h4>
                    <p>${iconDef.desc}</p>
                    <p><strong>${width}Ã—${height}</strong></p>
                    <div class="icon-preview"></div>
                    <button class="download-btn">ä¸‹è¼‰ PNG</button>
                `;
                
                iconItem.querySelector('.icon-preview').appendChild(canvas);
                iconGrid.appendChild(iconItem);
            });
        }

        // æ‰¹é‡ä¸‹è¼‰æ‰€æœ‰åœ–æ¨™
        async function downloadAllIcons() {
            if (generatedIcons.size === 0) {
                alert('è«‹å…ˆç”Ÿæˆåœ–æ¨™ï¼');
                return;
            }

            console.log('ğŸš€ é–‹å§‹æ‰¹é‡ä¸‹è¼‰æ‰€æœ‰åœ–æ¨™...');
            
            // é¡¯ç¤ºä¸‹è¼‰é€²åº¦
            const downloadBtn = document.getElementById('downloadAllBtn');
            const originalText = downloadBtn.textContent;
            
            let downloaded = 0;
            const total = generatedIcons.size;
            
            for (const [filename, iconData] of generatedIcons) {
                try {
                    // å‰µå»ºä¸‹è¼‰é€£çµ
                    const a = document.createElement('a');
                    a.href = iconData.url;
                    a.download = filename;
                    a.style.display = 'none';
                    
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    
                    downloaded++;
                    downloadBtn.textContent = `ä¸‹è¼‰ä¸­ ${downloaded}/${total}`;
                    
                    // çŸ­æš«å»¶é²ï¼Œé¿å…ç€è¦½å™¨é˜»æ“‹æ‰¹é‡ä¸‹è¼‰
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                } catch (error) {
                    console.error(`ä¸‹è¼‰ ${filename} å¤±æ•—:`, error);
                }
            }
            
            downloadBtn.textContent = originalText;
            console.log('âœ… æ‰€æœ‰åœ–æ¨™ä¸‹è¼‰å®Œæˆï¼');
            alert(`ğŸ‰ æˆåŠŸä¸‹è¼‰ ${downloaded} å€‹åœ–æ¨™ï¼\n\nè«‹å°‡é€™äº›PNGæª”æ¡ˆç§»å‹•åˆ° assets/icons/ ç›®éŒ„`);
        }

        // å‰µå»ºZIPä¸‹è¼‰åŠŸèƒ½ (å‚™é¸æ–¹æ¡ˆ)
        async function downloadAsZip() {
            if (generatedIcons.size === 0) {
                alert('è«‹å…ˆç”Ÿæˆåœ–æ¨™ï¼');
                return;
            }

            // å‹•æ…‹è¼‰å…¥JSZipåº«
            if (typeof JSZip === 'undefined') {
                console.log('æ­£åœ¨è¼‰å…¥ JSZip...');
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
                script.onload = () => downloadAsZip();
                document.head.appendChild(script);
                return;
            }

            const zip = new JSZip();
            
            for (const [filename, iconData] of generatedIcons) {
                zip.file(filename, iconData.blob);
            }
            
            zip.generateAsync({ type: 'blob' }).then(function(content) {
                const a = document.createElement('a');
                a.href = URL.createObjectURL(content);
                a.download = 'pwa-icons.zip';
                a.click();
            });
        }

        // é é¢è¼‰å…¥æ™‚è‡ªå‹•ç”Ÿæˆ
        window.addEventListener('load', generateAllIcons);
    </script>
</body>
</html>