<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SearchSettings & LocationManager æŒ‰éˆ•æ¨£å¼æ¸¬è©¦</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- ä¸»é¡Œæ¨£å¼ -->
    <style>
        :root {
            --theme-primary: #dc143c;
            --theme-accent: #ffd700;
            --text-primary: #ffffff;
            --text-secondary: #374151;
            --surface-color: #f9fafb;
            --border-color: #d1d5db;
            --success-color: #10b981;
        }
        
        [data-theme="maizuru"] {
            --theme-primary: #dc143c;
            --theme-accent: #ffd700;
        }
        
        [data-theme="qisu"] {
            --theme-primary: #8b5cf6;
            --theme-accent: #06b6d4;
        }
        
        [data-theme="muluInn"] {
            --theme-primary: #059669;
            --theme-accent: #f59e0b;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }
        
        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .theme-switcher button {
            margin: 0 4px;
            padding: 8px 16px;
            border: 2px solid #ddd;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .theme-switcher button:hover {
            background: #f0f0f0;
        }
        
        .theme-switcher button.active {
            background: var(--theme-primary);
            color: white;
            border-color: var(--theme-primary);
        }
    </style>
</head>
<body>
    <div class="theme-switcher">
        <button onclick="switchTheme('maizuru')" id="theme-maizuru" class="active">èˆé¶´</button>
        <button onclick="switchTheme('qisu')" id="theme-qisu">æŸ’å®¿</button>
        <button onclick="switchTheme('muluInn')" id="theme-muluInn">æ²æ—…</button>
    </div>

    <div class="container mx-auto max-w-4xl">
        <h1 class="text-3xl font-bold text-white text-center mb-8">
            SearchSettings & LocationManager æŒ‰éˆ•æ¨£å¼æ¸¬è©¦
        </h1>
        
        <!-- DistanceControl æŒ‰éˆ•æ¸¬è©¦ -->
        <div class="test-section">
            <h2 class="text-xl font-semibold mb-4">DistanceControl æŒ‰éˆ•æ¨£å¼</h2>
            <p class="text-gray-600 mb-4">æ¸¬è©¦è·é›¢æ§åˆ¶æŒ‰éˆ•çš„ä¸»è¦å’Œæ¬¡è¦ç‹€æ…‹</p>
            
            <div class="button-grid">
                <div>
                    <h3 class="font-medium mb-2">ä¸»è¦ç‹€æ…‹ (é¸ä¸­)</h3>
                    <button id="distance-primary" class="w-full">200m</button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">æ¬¡è¦ç‹€æ…‹ (æœªé¸ä¸­)</h3>
                    <button id="distance-secondary" class="w-full">1km</button>
                </div>
            </div>
        </div>
        
        <!-- LocationActions æŒ‰éˆ•æ¸¬è©¦ -->
        <div class="test-section">
            <h2 class="text-xl font-semibold mb-4">LocationActions æŒ‰éˆ•æ¨£å¼</h2>
            <p class="text-gray-600 mb-4">æ¸¬è©¦è‡ªå‹•å’Œæ‰‹å‹•å®šä½æŒ‰éˆ•çš„ä¸åŒç‹€æ…‹</p>
            
            <div class="button-grid">
                <div>
                    <h3 class="font-medium mb-2">è‡ªå‹•å®šä½ (æ­£å¸¸)</h3>
                    <button id="auto-location-normal" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ“</div>
                            <div>è‡ªå‹•å®šä½</div>
                        </div>
                    </button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">è‡ªå‹•å®šä½ (è¼‰å…¥ä¸­)</h3>
                    <button id="auto-location-loading" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>â³</div>
                            <div>å®šä½ä¸­...</div>
                        </div>
                    </button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">æ‰‹å‹•å®šä½ (å•Ÿç”¨)</h3>
                    <button id="manual-location-enabled" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ•</div>
                            <div>å®šä½åˆ°é€™è£¡</div>
                        </div>
                    </button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">æ‰‹å‹•å®šä½ (åœç”¨)</h3>
                    <button id="manual-location-disabled" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ•</div>
                            <div>å®šä½åˆ°é€™è£¡</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- QuickLocationButtons æŒ‰éˆ•æ¸¬è©¦ -->
        <div class="test-section">
            <h2 class="text-xl font-semibold mb-4">QuickLocationButtons æŒ‰éˆ•æ¨£å¼</h2>
            <p class="text-gray-600 mb-4">æ¸¬è©¦ä½å®¶å’Œå…¬å¸å¿«é€ŸæŒ‰éˆ•çš„ä¸åŒç‹€æ…‹</p>
            
            <div class="button-grid">
                <div>
                    <h3 class="font-medium mb-2">ä½å®¶ (æœªè¨­å®š)</h3>
                    <button id="home-unset" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ </div>
                            <div>ä½å®¶æœªè¨­å®š</div>
                        </div>
                    </button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">ä½å®¶ (å·²è¨­å®š)</h3>
                    <button id="home-set" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ </div>
                            <div>ä½å®¶</div>
                        </div>
                    </button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">å…¬å¸ (å¯å„²å­˜)</h3>
                    <button id="office-save" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ’¼</div>
                            <div>å„²å­˜å…¬å¸</div>
                        </div>
                    </button>
                </div>
                <div>
                    <h3 class="font-medium mb-2">å…¬å¸ (å·²è¨­å®š)</h3>
                    <button id="office-set" class="w-full">
                        <div class="flex flex-col items-center">
                            <div>ğŸ’¼</div>
                            <div>å…¬å¸</div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- æ¸¬è©¦çµæœ -->
        <div class="test-section">
            <h2 class="text-xl font-semibold mb-4">è‡ªå‹•æ¸¬è©¦çµæœ</h2>
            <div id="test-results" class="bg-gray-100 p-4 rounded-lg">
                <p class="text-gray-600">è¼‰å…¥æ¸¬è©¦ä¸­...</p>
            </div>
            <button onclick="runManualTest()" class="mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                é‡æ–°åŸ·è¡Œæ¸¬è©¦
            </button>
        </div>
    </div>

    <!-- è¼‰å…¥ ButtonStylesManager -->
    <script src="../components/shared/ButtonStylesManager.js"></script>
    
    <!-- è¼‰å…¥æ¸¬è©¦è…³æœ¬ -->
    <script src="validate-searchsettings-locationmanager-button-styles.js"></script>
    
    <script>
        let currentTheme = 'maizuru';
        
        // ä¸»é¡Œåˆ‡æ›å‡½æ•¸
        function switchTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            
            // æ›´æ–°ä¸»é¡ŒæŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.theme-switcher button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`theme-${theme}`).classList.add('active');
            
            // é‡æ–°æ‡‰ç”¨æŒ‰éˆ•æ¨£å¼
            applyButtonStyles();
        }
        
        // æ‡‰ç”¨æŒ‰éˆ•æ¨£å¼
        function applyButtonStyles() {
            if (!window.ButtonStylesManager) {
                console.error('ButtonStylesManager æœªè¼‰å…¥');
                return;
            }
            
            // DistanceControl æŒ‰éˆ•
            const distancePrimary = document.getElementById('distance-primary');
            const distanceSecondary = document.getElementById('distance-secondary');
            
            if (distancePrimary) {
                distancePrimary.className = 'w-full flex-1 px-4 py-3 rounded-lg font-semibold transition-all duration-200 min-h-[48px] border-2 shadow-md';
                Object.assign(distancePrimary.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'primary',
                    state: 'normal'
                }));
            }
            
            if (distanceSecondary) {
                distanceSecondary.className = 'w-full flex-1 px-4 py-3 rounded-lg font-semibold transition-all duration-200 min-h-[48px] border-2 shadow-md';
                Object.assign(distanceSecondary.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'secondary',
                    state: 'normal'
                }));
            }
            
            // LocationActions æŒ‰éˆ•
            const autoNormal = document.getElementById('auto-location-normal');
            const autoLoading = document.getElementById('auto-location-loading');
            const manualEnabled = document.getElementById('manual-location-enabled');
            const manualDisabled = document.getElementById('manual-location-disabled');
            
            [autoNormal, autoLoading, manualEnabled, manualDisabled].forEach(btn => {
                if (btn) {
                    btn.className = `w-full ${window.ButtonStylesManager.getButtonClasses('primary', 'standard')}`;
                }
            });
            
            if (autoNormal) {
                Object.assign(autoNormal.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'primary',
                    state: 'normal'
                }));
            }
            
            if (autoLoading) {
                Object.assign(autoLoading.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'primary',
                    state: 'loading'
                }));
            }
            
            if (manualEnabled) {
                Object.assign(manualEnabled.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'secondary',
                    state: 'normal'
                }));
            }
            
            if (manualDisabled) {
                Object.assign(manualDisabled.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'secondary',
                    state: 'disabled'
                }));
            }
            
            // QuickLocationButtons æŒ‰éˆ•
            const homeUnset = document.getElementById('home-unset');
            const homeSet = document.getElementById('home-set');
            const officeSave = document.getElementById('office-save');
            const officeSet = document.getElementById('office-set');
            
            [homeUnset, homeSet, officeSave, officeSet].forEach(btn => {
                if (btn) {
                    btn.className = `w-full ${window.ButtonStylesManager.getButtonClasses('primary', 'standard')}`;
                }
            });
            
            if (homeUnset) {
                Object.assign(homeUnset.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'secondary',
                    state: 'normal'
                }));
            }
            
            if (homeSet) {
                Object.assign(homeSet.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'success',
                    state: 'normal'
                }));
            }
            
            if (officeSave) {
                Object.assign(officeSave.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'primary',
                    state: 'normal'
                }));
            }
            
            if (officeSet) {
                Object.assign(officeSet.style, window.ButtonStylesManager.getButtonStyle({
                    variant: 'success',
                    state: 'normal'
                }));
            }
        }
        
        // æ‰‹å‹•åŸ·è¡Œæ¸¬è©¦
        function runManualTest() {
            const resultsDiv = document.getElementById('test-results');
            resultsDiv.innerHTML = '<p class="text-blue-600">åŸ·è¡Œæ¸¬è©¦ä¸­...</p>';
            
            if (window.runButtonStylesTests) {
                // é‡å®šå‘ console.log åˆ°çµæœå€åŸŸ
                const originalLog = console.log;
                const logs = [];
                
                console.log = function(...args) {
                    logs.push(args.join(' '));
                    originalLog.apply(console, args);
                };
                
                // åŸ·è¡Œæ¸¬è©¦
                window.runButtonStylesTests().then(() => {
                    // æ¢å¾© console.log
                    console.log = originalLog;
                    
                    // é¡¯ç¤ºçµæœ
                    resultsDiv.innerHTML = `
                        <div class="space-y-2">
                            ${logs.map(log => `<p class="text-sm ${log.includes('âœ…') ? 'text-green-600' : log.includes('âŒ') ? 'text-red-600' : 'text-gray-700'}">${log}</p>`).join('')}
                        </div>
                    `;
                }).catch(error => {
                    console.log = originalLog;
                    resultsDiv.innerHTML = `<p class="text-red-600">æ¸¬è©¦åŸ·è¡Œå¤±æ•—: ${error.message}</p>`;
                });
            } else {
                resultsDiv.innerHTML = '<p class="text-red-600">æ¸¬è©¦å‡½æ•¸æœªè¼‰å…¥</p>';
            }
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // ç­‰å¾… ButtonStylesManager è¼‰å…¥
            setTimeout(() => {
                applyButtonStyles();
                runManualTest();
            }, 500);
        });
        
        // ç›£è½ ButtonStylesManager è¼‰å…¥äº‹ä»¶
        window.addEventListener('buttonStylesManagerLoaded', function() {
            applyButtonStyles();
        });
    </script>
</body>
</html>