<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨­å‚™æª¢æ¸¬æ¸¬è©¦</title>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .detection-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .detection-title {
            font-size: 24px;
            font-weight: bold;
            color: #ff6b35;
            margin-bottom: 15px;
        }
        
        .detection-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detection-item:last-child {
            border-bottom: none;
        }
        
        .detection-label {
            font-weight: 600;
        }
        
        .detection-value {
            color: #ffd23f;
            font-family: monospace;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-true {
            background: #4caf50;
        }
        
        .status-false {
            background: #f44336;
        }
        
        .refresh-btn {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 5px;
            transition: transform 0.2s ease;
        }
        
        .refresh-btn:hover {
            transform: translateY(-2px);
        }
        
        .json-output {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            padding: 15px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="text-align: center; color: #ff6b35; margin-bottom: 40px;">
            ğŸ” è¨­å‚™æª¢æ¸¬æ¸¬è©¦
        </h1>
        
        <!-- åŸºæœ¬è¨­å‚™ä¿¡æ¯ -->
        <div class="detection-card">
            <div class="detection-title">ğŸ“± åŸºæœ¬è¨­å‚™ä¿¡æ¯</div>
            <div class="detection-item">
                <span class="detection-label">è¢å¹•å°ºå¯¸</span>
                <span class="detection-value" id="screenSize">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">è¦–çª—å°ºå¯¸</span>
                <span class="detection-value" id="viewportSize">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">åƒç´ å¯†åº¦</span>
                <span class="detection-value" id="pixelRatio">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">æ–¹å‘</span>
                <span class="detection-value" id="orientation">è¼‰å…¥ä¸­...</span>
            </div>
        </div>
        
        <!-- è§¸æ§å’Œäº¤äº’èƒ½åŠ› -->
        <div class="detection-card">
            <div class="detection-title">ğŸ‘† è§¸æ§å’Œäº¤äº’èƒ½åŠ›</div>
            <div class="detection-item">
                <span class="detection-label">è§¸æ§æ”¯æ´</span>
                <span class="detection-value" id="touchSupport">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">æ»‘é¼ æ‡¸åœ</span>
                <span class="detection-value" id="hoverSupport">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">åƒ…è§¸æ§è¨­å‚™</span>
                <span class="detection-value" id="touchOnly">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">æœ€å¤§è§¸æ§é»</span>
                <span class="detection-value" id="maxTouchPoints">è¼‰å…¥ä¸­...</span>
            </div>
        </div>
        
        <!-- User Agent æª¢æ¸¬ -->
        <div class="detection-card">
            <div class="detection-title">ğŸŒ User Agent æª¢æ¸¬</div>
            <div class="detection-item">
                <span class="detection-label">ç§»å‹•è¨­å‚™</span>
                <span class="detection-value" id="mobileUA">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">å¹³æ¿è¨­å‚™</span>
                <span class="detection-value" id="tabletUA">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">iOS è¨­å‚™</span>
                <span class="detection-value" id="iosUA">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">Android è¨­å‚™</span>
                <span class="detection-value" id="androidUA">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">ç€è¦½å™¨</span>
                <span class="detection-value" id="browser">è¼‰å…¥ä¸­...</span>
            </div>
        </div>
        
        <!-- åª’é«”æŸ¥è©¢æª¢æ¸¬ -->
        <div class="detection-card">
            <div class="detection-title">ğŸ“º åª’é«”æŸ¥è©¢æª¢æ¸¬</div>
            <div class="detection-item">
                <span class="detection-label">æ‰‹æ©Ÿåª’é«”æŸ¥è©¢</span>
                <span class="detection-value" id="mobileMedia">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">å¹³æ¿åª’é«”æŸ¥è©¢</span>
                <span class="detection-value" id="tabletMedia">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">æ¡Œé¢åª’é«”æŸ¥è©¢</span>
                <span class="detection-value" id="desktopMedia">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">é«˜å°æ¯”åº¦æ¨¡å¼</span>
                <span class="detection-value" id="highContrast">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">æ¸›å°‘å‹•ç•«åå¥½</span>
                <span class="detection-value" id="reducedMotion">è¼‰å…¥ä¸­...</span>
            </div>
        </div>
        
        <!-- æœ€çµ‚è¨­å‚™é¡å‹åˆ¤æ–· -->
        <div class="detection-card">
            <div class="detection-title">ğŸ¯ æœ€çµ‚è¨­å‚™é¡å‹åˆ¤æ–·</div>
            <div class="detection-item">
                <span class="detection-label">æª¢æ¸¬çµæœ</span>
                <span class="detection-value" id="finalDeviceType">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="detection-item">
                <span class="detection-label">æ»‘å‹•å°é½Šå•Ÿç”¨</span>
                <span class="detection-value" id="snapEnabled">è¼‰å…¥ä¸­...</span>
            </div>
        </div>
        
        <!-- æ§åˆ¶æŒ‰éˆ• -->
        <div style="text-align: center; margin: 30px 0;">
            <button class="refresh-btn" onclick="updateDetection()">ğŸ”„ é‡æ–°æª¢æ¸¬</button>
            <button class="refresh-btn" onclick="toggleFullscreen()">ğŸ“º å…¨è¢å¹•æ¸¬è©¦</button>
            <button class="refresh-btn" onclick="showRawData()">ğŸ“‹ é¡¯ç¤ºåŸå§‹æ•¸æ“š</button>
        </div>
        
        <!-- åŸå§‹æ•¸æ“šé¡¯ç¤º -->
        <div class="detection-card" id="rawDataCard" style="display: none;">
            <div class="detection-title">ğŸ“‹ åŸå§‹æª¢æ¸¬æ•¸æ“š</div>
            <div class="json-output" id="rawDataOutput"></div>
        </div>
    </div>

    <!-- è¼‰å…¥è…³æœ¬ -->
    <script src="../utils/snapScrollManager.js"></script>
    <script src="../utils/responsiveLayoutManager.js"></script>
    
    <script>
        // è¨­å‚™æª¢æ¸¬å‡½æ•¸ï¼ˆè¤‡è£½è‡ªæ»‘å‹•ç®¡ç†å™¨ï¼‰
        function detectDeviceType() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const userAgent = navigator.userAgent.toLowerCase();
            const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const devicePixelRatio = window.devicePixelRatio || 1;
            
            // æª¢æŸ¥ User Agent ä¸­çš„è¨­å‚™æ¨™è­˜
            const isMobileUA = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);
            const isTabletUA = /ipad|android(?!.*mobile)|tablet/i.test(userAgent);
            const isDesktopUA = !isMobileUA && !isTabletUA;
            
            // æª¢æŸ¥åª’é«”æŸ¥è©¢
            const isMobileMedia = window.matchMedia('(max-width: 767px)').matches;
            const isTabletMedia = window.matchMedia('(min-width: 768px) and (max-width: 1023px)').matches;
            const isDesktopMedia = window.matchMedia('(min-width: 1024px)').matches;
            
            // æª¢æŸ¥è§¸æ§èƒ½åŠ›
            const hasTouchOnly = hasTouch && window.matchMedia('(hover: none) and (pointer: coarse)').matches;
            const hasHover = window.matchMedia('(hover: hover)').matches;
            
            // æª¢æŸ¥æ–¹å‘å’Œæ¯”ä¾‹
            const isPortrait = height > width;
            const aspectRatio = width / height;
            
            // æª¢æŸ¥ç€è¦½å™¨
            const isIOS = /iphone|ipad|ipod/i.test(userAgent);
            const isAndroid = /android/i.test(userAgent);
            const isSafari = /safari/i.test(userAgent) && !/chrome/i.test(userAgent);
            const isChrome = /chrome/i.test(userAgent);
            const isFirefox = /firefox/i.test(userAgent);
            const isEdge = /edge/i.test(userAgent);
            
            // æª¢æŸ¥ç‰¹æ®Šåå¥½
            const prefersHighContrast = window.matchMedia('(prefers-contrast: high)').matches;
            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            
            // ç¶œåˆåˆ¤æ–·é‚è¼¯
            let deviceType = 'desktop';
            
            // æ‰‹æ©Ÿåˆ¤æ–·ï¼šå°è¢å¹• + è§¸æ§ + ç§»å‹•ç«¯ UA + è±å±å‚¾å‘
            if ((width < 768 || isMobileUA) && hasTouch && !isTabletUA) {
                deviceType = 'mobile';
            }
            // å¹³æ¿åˆ¤æ–·ï¼šä¸­ç­‰è¢å¹• + è§¸æ§ + å¹³æ¿ UA æˆ– å¤§è¢å¹•è§¸æ§è¨­å‚™
            else if (((width >= 768 && width < 1024) || isTabletUA) && hasTouch && !hasHover) {
                deviceType = 'tablet';
            }
            // æ¡Œé¢åˆ¤æ–·ï¼šå¤§è¢å¹• + æ»‘é¼ æ‡¸åœ + éè§¸æ§ä¸»è¦æ“ä½œ
            else if (width >= 1024 && hasHover && !hasTouchOnly) {
                deviceType = 'desktop';
            }
            // æ··åˆè¨­å‚™ï¼ˆå¦‚ Surfaceï¼‰ï¼šæ ¹æ“šè¢å¹•å¤§å°å’Œä¸»è¦äº¤äº’æ–¹å¼
            else if (hasTouch && hasHover) {
                if (width < 768) {
                    deviceType = 'mobile';
                } else if (width < 1024) {
                    deviceType = 'tablet';
                } else {
                    deviceType = 'desktop'; // å¤§è¢å¹•è§¸æ§è¨­å‚™ç•¶ä½œæ¡Œé¢è™•ç†
                }
            }
            
            return {
                type: deviceType,
                width: width,
                height: height,
                hasTouch: hasTouch,
                hasHover: hasHover,
                hasTouchOnly: hasTouchOnly,
                devicePixelRatio: devicePixelRatio,
                isPortrait: isPortrait,
                aspectRatio: aspectRatio,
                userAgent: {
                    isMobile: isMobileUA,
                    isTablet: isTabletUA,
                    isDesktop: isDesktopUA,
                    isIOS: isIOS,
                    isAndroid: isAndroid,
                    isSafari: isSafari,
                    isChrome: isChrome,
                    isFirefox: isFirefox,
                    isEdge: isEdge,
                    raw: userAgent
                },
                mediaQuery: {
                    isMobile: isMobileMedia,
                    isTablet: isTabletMedia,
                    isDesktop: isDesktopMedia
                },
                preferences: {
                    highContrast: prefersHighContrast,
                    reducedMotion: prefersReducedMotion
                }
            };
        }
        
        // æ ¼å¼åŒ–å¸ƒæ—å€¼é¡¯ç¤º
        function formatBoolean(value) {
            const indicator = value ? 
                '<span class="status-indicator status-true"></span>' : 
                '<span class="status-indicator status-false"></span>';
            return indicator + (value ? 'æ˜¯' : 'å¦');
        }
        
        // æ›´æ–°æª¢æ¸¬çµæœ
        function updateDetection() {
            const detection = detectDeviceType();
            
            // åŸºæœ¬è¨­å‚™ä¿¡æ¯
            document.getElementById('screenSize').textContent = 
                `${screen.width}Ã—${screen.height}`;
            document.getElementById('viewportSize').textContent = 
                `${detection.width}Ã—${detection.height}`;
            document.getElementById('pixelRatio').textContent = 
                detection.devicePixelRatio;
            document.getElementById('orientation').textContent = 
                detection.isPortrait ? 'è±å±' : 'æ©«å±';
            
            // è§¸æ§å’Œäº¤äº’èƒ½åŠ›
            document.getElementById('touchSupport').innerHTML = 
                formatBoolean(detection.hasTouch);
            document.getElementById('hoverSupport').innerHTML = 
                formatBoolean(detection.hasHover);
            document.getElementById('touchOnly').innerHTML = 
                formatBoolean(detection.hasTouchOnly);
            document.getElementById('maxTouchPoints').textContent = 
                navigator.maxTouchPoints || '0';
            
            // User Agent æª¢æ¸¬
            document.getElementById('mobileUA').innerHTML = 
                formatBoolean(detection.userAgent.isMobile);
            document.getElementById('tabletUA').innerHTML = 
                formatBoolean(detection.userAgent.isTablet);
            document.getElementById('iosUA').innerHTML = 
                formatBoolean(detection.userAgent.isIOS);
            document.getElementById('androidUA').innerHTML = 
                formatBoolean(detection.userAgent.isAndroid);
            
            // ç€è¦½å™¨æª¢æ¸¬
            let browserName = 'æœªçŸ¥';
            if (detection.userAgent.isChrome) browserName = 'Chrome';
            else if (detection.userAgent.isSafari) browserName = 'Safari';
            else if (detection.userAgent.isFirefox) browserName = 'Firefox';
            else if (detection.userAgent.isEdge) browserName = 'Edge';
            
            document.getElementById('browser').textContent = browserName;
            
            // åª’é«”æŸ¥è©¢æª¢æ¸¬
            document.getElementById('mobileMedia').innerHTML = 
                formatBoolean(detection.mediaQuery.isMobile);
            document.getElementById('tabletMedia').innerHTML = 
                formatBoolean(detection.mediaQuery.isTablet);
            document.getElementById('desktopMedia').innerHTML = 
                formatBoolean(detection.mediaQuery.isDesktop);
            document.getElementById('highContrast').innerHTML = 
                formatBoolean(detection.preferences.highContrast);
            document.getElementById('reducedMotion').innerHTML = 
                formatBoolean(detection.preferences.reducedMotion);
            
            // æœ€çµ‚åˆ¤æ–·
            document.getElementById('finalDeviceType').textContent = 
                detection.type === 'mobile' ? 'ğŸ“± æ‰‹æ©Ÿ' :
                detection.type === 'tablet' ? 'ğŸ“± å¹³æ¿' : 'ğŸ’» æ¡Œé¢';
            
            const snapEnabled = detection.type !== 'desktop';
            document.getElementById('snapEnabled').innerHTML = 
                formatBoolean(snapEnabled);
            
            // å„²å­˜åŸå§‹æ•¸æ“š
            window.lastDetection = detection;
            
            console.log('ğŸ” è¨­å‚™æª¢æ¸¬çµæœ:', detection);
        }
        
        // é¡¯ç¤ºåŸå§‹æ•¸æ“š
        function showRawData() {
            const card = document.getElementById('rawDataCard');
            const output = document.getElementById('rawDataOutput');
            
            if (card.style.display === 'none') {
                card.style.display = 'block';
                output.textContent = JSON.stringify(window.lastDetection, null, 2);
            } else {
                card.style.display = 'none';
            }
        }
        
        // å…¨è¢å¹•æ¸¬è©¦
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().then(() => {
                    setTimeout(updateDetection, 100);
                });
            } else {
                document.exitFullscreen().then(() => {
                    setTimeout(updateDetection, 100);
                });
            }
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateDetection();
            
            // ç›£è½è¦–çª—å¤§å°è®ŠåŒ–
            window.addEventListener('resize', function() {
                setTimeout(updateDetection, 100);
            });
            
            // ç›£è½æ–¹å‘è®ŠåŒ–
            window.addEventListener('orientationchange', function() {
                setTimeout(updateDetection, 200);
            });
        });
    </script>
</body>
</html>