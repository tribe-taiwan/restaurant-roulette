<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è€è™æ©Ÿå‹•ç•«æ¸¬è©¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* å‹•æ…‹ç”Ÿæˆçš„CSSå‹•ç•«å°‡æ’å…¥é€™è£¡ */
        .slot-container {
            width: 256px;      /* èˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒï¼šw-64 = 256px */
            height: 256px;     /* èˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒï¼šh-64 = 256px */
            overflow: hidden !important;  /* å¼·åˆ¶éš±è—è¶…å‡ºéƒ¨åˆ† */
            border: 3px solid #fbbf24;
            border-radius: 12px 12px 0 0;  /* èˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒçš„rounded-t-lg */
            position: relative;
            background: #000;  /* é»‘è‰²èƒŒæ™¯ä¾¿æ–¼è§€å¯Ÿ */
            margin: 0 auto;    /* ç½®ä¸­ */
        }
        
        .slot-strip {
            display: flex;
            flex-direction: row;
            height: 100%;
            width: fit-content;  /* è®“å®¹å™¨é©æ‡‰æ‰€æœ‰åœ–ç‰‡çš„å¯¬åº¦ */
        }
        
        .slot-image {
            width: 256px;    /* èˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒï¼šw-64 = 256px */
            height: 256px;   /* èˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒï¼šh-64 = 256px */
            flex-shrink: 0;  /* é˜²æ­¢åœ–ç‰‡è¢«å£“ç¸® */
            flex-grow: 0;    /* é˜²æ­¢åœ–ç‰‡è¢«æ‹‰ä¼¸ */
            object-fit: cover;  /* ä¿æŒåœ–ç‰‡æ¯”ä¾‹ï¼Œè£åˆ‡å¡«æ»¿ */
            display: block;  /* ç¢ºä¿åœ–ç‰‡æ­£ç¢ºé¡¯ç¤º */
        }
        
        /* é è¨­å‹•ç•«æ¨£å¼ */
        .animate-slot {
            animation: slotAnimation 1s linear infinite;
        }
        
        @keyframes slotAnimation {
            0% { transform: translateX(0); }
            100% { transform: translateX(-256px); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold mb-8 text-center text-yellow-400">ğŸ° è€è™æ©Ÿå‹•ç•«æ¸¬è©¦</h1>
        
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- å·¦å´ï¼šè€è™æ©Ÿå±•ç¤º -->
            <div class="text-center">
                <div class="flex justify-center mb-4">
                    <div id="slotContainer" class="slot-container">
                        <div id="slotStrip" class="slot-strip">
                            <!-- åœ–ç‰‡å°‡å‹•æ…‹è¼‰å…¥ -->
                        </div>
                    </div>
                </div>
                
                <div class="space-y-3">
                    <button id="toggleBtn" class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded font-bold">
                        ğŸ° é–‹å§‹è½‰å‹•
                    </button>
                    
                    <!-- é—œéµæŒ‡æ¨™é¡¯ç¤º -->
                    <div class="bg-purple-800 p-3 rounded-lg border border-purple-600">
                        <div class="text-center">
                            <div class="text-sm text-purple-200">â±ï¸ æ¯å¼µåœ–ç‰‡é¡¯ç¤ºæ™‚é–“</div>
                            <div class="text-2xl font-bold text-purple-100" id="displayTimeIndicator">0.40s</div>
                            <div class="text-xs text-purple-300">é€™æ˜¯èª¿æ•´è€è™æ©Ÿé€Ÿåº¦çš„é—œéµæŒ‡æ¨™</div>
                        </div>
                    </div>
                    
                    <!-- é¡è‰²ç·¨ç¢¼èªªæ˜ -->
                    <div class="text-xs text-gray-400">
                        <span class="inline-block w-3 h-3 bg-red-500 rounded mr-1"></span>â‰¤0.2s å¤ªå¿«ã€€
                        <span class="inline-block w-3 h-3 bg-yellow-500 rounded mr-1"></span>0.2-0.3s å¿«ã€€
                        <span class="inline-block w-3 h-3 bg-green-500 rounded mr-1"></span>0.3-0.5s ç†æƒ³ã€€
                        <span class="inline-block w-3 h-3 bg-blue-500 rounded mr-1"></span>>0.5s æ…¢
                    </div>
                </div>
            </div>
            
            <!-- å³å´ï¼šåƒæ•¸èª¿æ•´ -->
            <div>
                <h2 class="text-xl font-bold mb-4">åƒæ•¸èª¿æ•´</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-bold mb-2">æ¯å¼µåœ–ç‰‡é¡¯ç¤ºæ™‚é–“ (ç§’)</label>
                        <input type="range" id="durationSlider" min="0.1" max="1.0" step="0.05" value="0.4" 
                               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                        <div class="text-center text-yellow-400" id="durationValue">0.40s/å¼µ</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-bold mb-2">å‹•ç•«åºåˆ—é•·åº¦</label>
                        <input type="range" id="imageCountSlider" min="3" max="20" step="1" value="8" 
                               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                        <div class="text-center text-yellow-400" id="imageCountValue">ä½¿ç”¨8å¼µåœ–ç‰‡</div>
                        <div class="text-xs text-gray-400 mt-1">æ§åˆ¶å‹•ç•«åºåˆ—ä¸­çš„åœ–ç‰‡ç¸½æ•¸ï¼ˆç¸½æ™‚é–“æœƒè‡ªå‹•è¨ˆç®—ï¼‰</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-bold mb-2">å‹•ç•«å‡½æ•¸</label>
                        <select id="timingFunction" class="w-full p-2 bg-gray-700 rounded">
                            <option value="linear">linear (ç­‰é€Ÿ)</option>
                            <option value="ease">ease (ç·©å‹•)</option>
                            <option value="ease-in">ease-in (åŠ é€Ÿ)</option>
                            <option value="ease-out">ease-out (æ¸›é€Ÿ)</option>
                            <option value="ease-in-out">ease-in-out (å…ˆåŠ é€Ÿå¾Œæ¸›é€Ÿ)</option>
                        </select>
                        <div class="text-xs text-gray-400 mt-1">æ§åˆ¶å‹•ç•«çš„é€Ÿåº¦è®ŠåŒ–æ›²ç·š</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-bold mb-2">åœ–ç‰‡å¯¬åº¦ (px) - æ­£æ–¹å½¢</label>
                        <input type="range" id="imageWidthSlider" min="200" max="400" step="16" value="256" 
                               class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">
                        <div class="text-center text-yellow-400" id="imageWidthValue">256px</div>
                        <div class="text-xs text-gray-400 mt-1">æ¯å¼µåœ–ç‰‡å¯¬åº¦ (å®¹å™¨å›ºå®š256pxÃ—256pxæ­£æ–¹å½¢ï¼Œèˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒ)</div>
                    </div>
                    
                    <div>
                        <label class="flex items-center space-x-2">
                            <input type="checkbox" id="infiniteLoop" checked class="form-checkbox">
                            <span>ç„¡é™å¾ªç’°</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æŠ€è¡“è³‡è¨Šé¡¯ç¤ºå€ -->
        <div class="bg-gray-800 p-6 rounded-lg">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">ğŸ“‹ æŠ€è¡“åƒæ•¸è³‡è¨Š</h2>
                <button id="copyBtn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded text-sm">
                    ğŸ“‹ è¤‡è£½åƒæ•¸
                </button>
            </div>
            <pre id="techInfo" class="bg-black p-4 rounded text-green-400 font-mono text-sm overflow-x-auto"></pre>
        </div>
        
        <!-- åœ–ç‰‡è·¯å¾‘é¡¯ç¤º -->
        <div class="mt-6 bg-gray-800 p-4 rounded-lg">
            <h3 class="text-lg font-bold mb-2">ğŸ–¼ï¸ è¼‰å…¥çš„åœ–ç‰‡</h3>
            <div id="imageList" class="text-sm text-gray-400"></div>
        </div>
    </div>

    <script>
        class SlotMachineTest {
            constructor() {
                this.images = [];
                this.currentAnimation = null;
                this.isSpinning = false;
                
                this.initElements();
                this.loadImages();
                this.bindEvents();
                this.updateTechInfo();
            }
            
            initElements() {
                this.slotStrip = document.getElementById('slotStrip');
                this.slotContainer = document.getElementById('slotContainer');
                this.toggleBtn = document.getElementById('toggleBtn');
                this.durationSlider = document.getElementById('durationSlider');
                this.durationValue = document.getElementById('durationValue');
                this.imageCountSlider = document.getElementById('imageCountSlider');
                this.imageCountValue = document.getElementById('imageCountValue');
                this.timingFunction = document.getElementById('timingFunction');
                this.imageWidthSlider = document.getElementById('imageWidthSlider');
                this.imageWidthValue = document.getElementById('imageWidthValue');
                this.infiniteLoop = document.getElementById('infiniteLoop');
                this.techInfo = document.getElementById('techInfo');
                this.copyBtn = document.getElementById('copyBtn');
                this.imageList = document.getElementById('imageList');
                this.displayTimeIndicator = document.getElementById('displayTimeIndicator');
            }
            
            async loadImages() {
                const basePath = '../assets/image/slot-machine';
                const detectedImages = [];
                const extensions = ['.jpg', '.jpeg', '.png', '.webp', '.gif'];
                
                // è‡ªå‹•åµæ¸¬å¯ç”¨çš„slotåœ–ç‰‡ï¼ˆæ”¯æ´å¤šç¨®æ ¼å¼ï¼Œç„¡æ•¸é‡é™åˆ¶ï¼‰
                let i = 1;
                while (true) {
                    let imageFound = false;
                    
                    // å˜—è©¦æ¯ç¨®å‰¯æª”å
                    for (const ext of extensions) {
                        const imagePath = `${basePath}/slot (${i})${ext}`;
                        try {
                            const response = await fetch(imagePath, { method: 'HEAD' });
                            if (response.ok) {
                                detectedImages.push(imagePath);
                                imageFound = true;
                                break; // æ‰¾åˆ°å°±è·³å‡ºå‰¯æª”åè¿´åœˆ
                            }
                        } catch (error) {
                            // ç¹¼çºŒå˜—è©¦ä¸‹ä¸€å€‹å‰¯æª”å
                        }
                    }
                    
                    if (!imageFound) {
                        break; // æ²’æ‰¾åˆ°ä»»ä½•æ ¼å¼çš„åœ–ç‰‡ï¼Œåœæ­¢æœå°‹
                    }
                    
                    i++;
                    
                    // å®‰å…¨ä¸Šé™ï¼Œé¿å…ç„¡é™è¿´åœˆï¼ˆä½†æ¯”åŸä¾†çš„20å¼µé«˜å¾ˆå¤šï¼‰
                    if (i > 100) {
                        console.warn('âš ï¸ é”åˆ°åœ–ç‰‡æœå°‹ä¸Šé™100å¼µï¼Œåœæ­¢æœå°‹');
                        break;
                    }
                }
                
                this.images = detectedImages;
                this.updateImageList();
                this.generateSlotStrip();
                
                console.log(`ğŸ° è¼‰å…¥äº† ${this.images.length} å¼µslotåœ–ç‰‡ï¼Œæ”¯æ´æ ¼å¼: ${extensions.join(', ')}`);
            }
            
            updateImageList() {
                this.imageList.innerHTML = this.images.map((img, index) => 
                    `${index + 1}. ${img.split('/').pop()}`
                ).join('<br>');
            }
            
            generateSlotStrip() {
                const imageCount = parseInt(this.imageCountSlider.value);
                const imageWidth = parseInt(this.imageWidthSlider.value);
                
                // å®¹å™¨ä¿æŒæ­£æ–¹å½¢ï¼Œä¸éœ€è¦å‹•æ…‹èª¿æ•´å°ºå¯¸
                const container = document.querySelector('.slot-container');
                // container.style.widthä¿æŒCSSä¸­çš„è¨­å®šï¼šwidth: 256px
                // container.style.heightä¿æŒCSSä¸­çš„è¨­å®šï¼šheight: 256px
                
                // æ¸…ç©ºç¾æœ‰åœ–ç‰‡
                this.slotStrip.innerHTML = '';
                
                // ç”Ÿæˆåœ–ç‰‡åºåˆ— (å¾ªç’°ä½¿ç”¨å¯ç”¨åœ–ç‰‡)
                for (let i = 0; i < imageCount; i++) {
                    const img = document.createElement('img');
                    img.src = this.images[i % this.images.length];
                    img.className = 'slot-image';
                    img.style.width = imageWidth + 'px';
                    img.style.height = imageWidth + 'px';
                    img.alt = `Slot ${i + 1}`;
                    
                    // æ·»åŠ é‚Šæ¡†ä¾¿æ–¼è­˜åˆ¥æ¯å¼µåœ–ç‰‡
                    img.style.border = '1px solid #ff6b35';
                    
                    this.slotStrip.appendChild(img);
                }
                
                // é‡ç½®å‹•ç•«ä½ç½®
                this.slotStrip.style.transform = 'translateX(0)';
            }
            
            bindEvents() {
                this.toggleBtn.addEventListener('click', () => this.toggleAnimation());
                this.copyBtn.addEventListener('click', () => this.copyTechInfo());
                
                // åƒæ•¸è®Šæ›´äº‹ä»¶
                [this.durationSlider, this.imageCountSlider, this.imageWidthSlider, this.timingFunction, this.infiniteLoop]
                    .forEach(element => {
                        element.addEventListener('input', () => {
                            this.updateValues();
                            this.updateAnimation();
                            this.updateTechInfo();
                        });
                        element.addEventListener('change', () => {
                            if (element === this.imageCountSlider || element === this.imageWidthSlider) {
                                this.generateSlotStrip();
                            }
                        });
                    });
            }
            
            updateValues() {
                const timePerImage = parseFloat(this.durationSlider.value);
                const imageCount = parseInt(this.imageCountSlider.value);
                
                // è¨ˆç®—ç¸½å‹•ç•«æ™‚é–“ = æ¯å¼µåœ–ç‰‡é¡¯ç¤ºæ™‚é–“ Ã— åœ–ç‰‡æ•¸é‡
                const totalDuration = (timePerImage * imageCount).toFixed(2);
                
                this.durationValue.textContent = timePerImage.toFixed(2) + 's/å¼µ';
                this.imageCountValue.textContent = 'ä½¿ç”¨' + imageCount + 'å¼µåœ–ç‰‡ (ç¸½æ™‚é–“' + totalDuration + 's)';
                this.imageWidthValue.textContent = this.imageWidthSlider.value + 'px';
                
                // æ›´æ–°é—œéµæŒ‡æ¨™ï¼šæ¯å¼µåœ–ç‰‡é¡¯ç¤ºæ™‚é–“ï¼ˆç¾åœ¨å°±æ˜¯ç”¨æˆ¶è¨­å®šçš„å€¼ï¼‰
                this.displayTimeIndicator.textContent = timePerImage.toFixed(2) + 's';
                
                // æ ¹æ“šé€Ÿåº¦èª¿æ•´å®¹å™¨é‚Šæ¡†é¡è‰²å’ŒæŒ‡æ¨™é¡è‰²
                if (timePerImage <= 0.2) {
                    // å¤ªå¿«ï¼Œç´…è‰²
                    this.displayTimeIndicator.className = 'text-2xl font-bold text-red-300';
                    this.slotContainer.style.borderColor = '#ef4444'; // red-500
                } else if (timePerImage <= 0.3) {
                    // å¿«ï¼Œé»ƒè‰²
                    this.displayTimeIndicator.className = 'text-2xl font-bold text-yellow-300';
                    this.slotContainer.style.borderColor = '#eab308'; // yellow-500
                } else if (timePerImage <= 0.5) {
                    // ç†æƒ³ï¼Œç¶ è‰²
                    this.displayTimeIndicator.className = 'text-2xl font-bold text-green-300';
                    this.slotContainer.style.borderColor = '#22c55e'; // green-500
                } else {
                    // æ…¢ï¼Œè—è‰²
                    this.displayTimeIndicator.className = 'text-2xl font-bold text-blue-300';
                    this.slotContainer.style.borderColor = '#3b82f6'; // blue-500
                }
            }
            
            updateAnimation() {
                if (!this.isSpinning) return;
                
                const timePerImage = parseFloat(this.durationSlider.value);
                const imageCount = parseInt(this.imageCountSlider.value);
                const imageWidth = parseInt(this.imageWidthSlider.value);
                const timing = this.timingFunction.value;
                const infinite = this.infiniteLoop.checked ? 'infinite' : 'forwards';
                
                // è¨ˆç®—ç¸½å‹•ç•«æ™‚é–“ = æ¯å¼µåœ–ç‰‡é¡¯ç¤ºæ™‚é–“ Ã— åœ–ç‰‡æ•¸é‡
                const totalDuration = timePerImage * imageCount;
                
                // è¨ˆç®—ç§»å‹•è·é›¢ - ç§»å‹•æ‰€æœ‰åœ–ç‰‡çš„è·é›¢ (æ¨¡æ“¬fastæ¨¡å¼)
                const totalDistance = (imageCount - 1) * imageWidth;
                
                // ç§»é™¤èˆŠå‹•ç•«
                const oldStyle = document.getElementById('dynamicAnimation');
                if (oldStyle) oldStyle.remove();
                
                // å‰µå»ºæ–°å‹•ç•«
                const style = document.createElement('style');
                style.id = 'dynamicAnimation';
                style.textContent = `
                    @keyframes currentSlotAnimation {
                        0% { transform: translateX(0); }
                        100% { transform: translateX(-${totalDistance}px); }
                    }
                    .current-slot-animation {
                        animation: currentSlotAnimation ${totalDuration}s ${timing} ${infinite};
                    }
                `;
                document.head.appendChild(style);
                
                // æ‡‰ç”¨æ–°å‹•ç•«
                this.slotStrip.className = 'slot-strip current-slot-animation';
            }
            
            toggleAnimation() {
                if (this.isSpinning) {
                    // åœæ­¢å‹•ç•«
                    this.isSpinning = false;
                    this.slotStrip.className = 'slot-strip';
                    this.toggleBtn.textContent = 'ğŸ° é–‹å§‹è½‰å‹•';
                    this.toggleBtn.className = 'bg-green-600 hover:bg-green-700 px-6 py-2 rounded font-bold';
                } else {
                    // é–‹å§‹å‹•ç•«
                    this.isSpinning = true;
                    this.updateAnimation();
                    this.toggleBtn.textContent = 'ğŸ›‘ åœæ­¢è½‰å‹•';
                    this.toggleBtn.className = 'bg-red-600 hover:bg-red-700 px-6 py-2 rounded font-bold';
                }
                this.updateTechInfo();
            }
            
            updateTechInfo() {
                const timePerImage = parseFloat(this.durationSlider.value);
                const imageCount = parseInt(this.imageCountSlider.value);
                const imageWidth = parseInt(this.imageWidthSlider.value);
                const timing = this.timingFunction.value;
                const infinite = this.infiniteLoop.checked;
                const totalDuration = timePerImage * imageCount;
                const totalDistance = (imageCount - 1) * imageWidth;
                
                const info = {
                    "ç‹€æ…‹": this.isSpinning ? "ğŸ° è½‰å‹•ä¸­" : "â¹ï¸ åœæ­¢",
                    "æ¯å¼µåœ–ç‰‡é¡¯ç¤ºæ™‚é–“": timePerImage.toFixed(2) + "s (ç”¨æˆ¶è¨­å®šçš„å›ºå®šå€¼)",
                    "å‹•ç•«ç¸½æŒçºŒæ™‚é–“": totalDuration.toFixed(2) + "s (è‡ªå‹•è¨ˆç®—: " + timePerImage.toFixed(2) + "s Ã— " + imageCount + "å¼µ)",
                    "å‹•ç•«åºåˆ—é•·åº¦": imageCount + "å¼µ (ä¾åºé¡¯ç¤º" + imageCount + "å¼µåœ–ç‰‡)",
                    "å®¹å™¨å°ºå¯¸": "256px Ã— 256px (æ­£æ–¹å½¢ï¼Œèˆ‡ç”Ÿç”¢ç‰ˆæœ¬ç›¸åŒ)",
                    "åœ–ç‰‡å¯¬åº¦": imageWidth + "px (æ¯å¼µåœ–ç‰‡çš„å¯¦éš›å¯¬åº¦)",
                    "å‹•ç•«é€Ÿåº¦æ›²ç·š": timing,
                    "ç„¡é™å¾ªç’°": infinite ? "æ˜¯ (æ°¸ä¸åœæ­¢)" : "å¦ (æ’­æ”¾ä¸€æ¬¡å¾Œåœæ­¢)",
                    "åœ–ç‰‡åºåˆ—ç¸½å¯¬åº¦": (imageCount * imageWidth) + "px",
                    "å‹•ç•«ç§»å‹•è·é›¢": totalDistance + "px (å‘å·¦ç§»å‹•ï¼Œæ»¾å‹•" + (imageCount-1) + "å¼µåœ–ç‰‡)",
                    "å¯¦éš›è¼‰å…¥åœ–ç‰‡æª”æ¡ˆ": this.images.length + "å¼µ (æ”¯æ´.jpg/.jpeg/.png/.webp/.gif)",
                    "æ¨¡æ“¬æ¨¡å¼": "FASTæ¨¡å¼ (å¿«é€Ÿæ»¾å‹•æ‰€æœ‰åœ–ç‰‡ï¼Œæ¯å¼µå›ºå®šé¡¯ç¤ºæ™‚é–“)",
                    "æ»¾å‹•é€Ÿåº¦": (totalDistance / totalDuration).toFixed(0) + "px/s",
                    "CSSå‹•ç•«å®£å‘Š": `animation: slotAnimation ${totalDuration.toFixed(2)}s ${timing} ${infinite ? 'infinite' : 'forwards'}`,
                    "CSSé—œéµå¹€å®šç¾©": `@keyframes slotAnimation {\n  0% { transform: translateX(0); }\n  100% { transform: translateX(-${totalDistance}px); }\n}`,
                    "å®¹å™¨CSSè¨­å®š": `width: 256px; height: 256px; overflow: hidden; (æ­£æ–¹å½¢)`,
                    "åœ–ç‰‡CSSè¨­å®š": `width: ${imageWidth}px; height: ${imageWidth}px; object-fit: cover;`
                };
                
                this.techInfo.textContent = JSON.stringify(info, null, 2);
            }
            
            copyTechInfo() {
                navigator.clipboard.writeText(this.techInfo.textContent).then(() => {
                    this.copyBtn.textContent = 'âœ… å·²è¤‡è£½';
                    setTimeout(() => {
                        this.copyBtn.textContent = 'ğŸ“‹ è¤‡è£½åƒæ•¸';
                    }, 2000);
                });
            }
        }
        
        // åˆå§‹åŒ–æ¸¬è©¦å™¨
        document.addEventListener('DOMContentLoaded', () => {
            new SlotMachineTest();
        });
    </script>
</body>
</html>