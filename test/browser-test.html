<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç€è¦½å™¨èªæ³•æ¸¬è©¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react@18/umd/react.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100 p-8">
    <div id="root">
        <div class="text-center">
            <h1 class="text-2xl font-bold mb-4">ç€è¦½å™¨èªæ³•æ¸¬è©¦</h1>
            <div id="status" class="text-lg">è¼‰å…¥ä¸­...</div>
        </div>
    </div>

    <script>
        console.log('ğŸ” é–‹å§‹ç€è¦½å™¨æ¸¬è©¦...');
        
        // æ¨¡æ“¬å…¨å±€å‡½æ•¸
        window.getPriceLabels = () => ({
            zh: { 1: 'ä¾¿å®œ', 2: 'ä¸­ç­‰', 3: 'æ˜‚è²´', 4: 'å¾ˆè²´' },
            en: { 1: 'Cheap', 2: 'Moderate', 3: 'Expensive', 4: 'Very Expensive' }
        });

        window.renderStars = (rating) => {
            if (!rating) return null;
            const stars = [];
            for (let i = 1; i <= 5; i++) {
                stars.push({
                    key: i,
                    className: i <= rating ? 'text-yellow-400' : 'text-gray-300',
                    symbol: 'â˜…'
                });
            }
            return stars;
        };

        window.getDirectionsUrl = (restaurant, userLocation, userAddress, language) => {
            return `https://www.google.com/maps/dir/?api=1&destination=${restaurant.name}`;
        };

        // æ¸¬è©¦è¼‰å…¥ SlotMachine.js
        fetch('/components/SlotMachine.js')
            .then(response => {
                console.log('ğŸ“¡ SlotMachine.js éŸ¿æ‡‰ç‹€æ…‹:', response.status);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                return response.text();
            })
            .then(code => {
                console.log('ğŸ“„ SlotMachine.js è¼‰å…¥æˆåŠŸï¼Œå¤§å°:', code.length);
                
                // å˜—è©¦ç”¨ Babel è½‰æ›
                try {
                    const transformed = Babel.transform(code, {
                        presets: ['react']
                    });
                    console.log('âœ… Babel è½‰æ›æˆåŠŸ');
                    
                    // åŸ·è¡Œè½‰æ›å¾Œçš„ä»£ç¢¼
                    eval(transformed.code);
                    
                    if (typeof window.SlotMachine === 'function') {
                        console.log('âœ… SlotMachine çµ„ä»¶å·²å®šç¾©');
                        
                        document.getElementById('root').innerHTML = `
                            <div class="text-center">
                                <h1 class="text-2xl font-bold mb-4 text-green-600">âœ… æ¸¬è©¦æˆåŠŸ</h1>
                                <div class="space-y-2">
                                    <div class="text-green-600">âœ… React æ­£å¸¸å·¥ä½œ</div>
                                    <div class="text-green-600">âœ… SlotMachine.js è¼‰å…¥æˆåŠŸ</div>
                                    <div class="text-green-600">âœ… Babel è½‰æ›æˆåŠŸ</div>
                                    <div class="text-green-600">âœ… SlotMachine çµ„ä»¶å·²å®šç¾©</div>
                                    <div class="text-green-600">âœ… æ»‘å‹•è½‰å ´æ•ˆæœå·²æ·»åŠ </div>
                                </div>
                                <div class="mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
                                    <strong>æˆåŠŸï¼</strong> SlotMachine çµ„ä»¶å¯ä»¥æ­£å¸¸è¼‰å…¥å’Œä½¿ç”¨
                                </div>
                            </div>
                        `;
                    } else {
                        throw new Error('SlotMachine çµ„ä»¶æœªå®šç¾©');
                    }
                    
                } catch (babelError) {
                    console.error('âŒ Babel è½‰æ›å¤±æ•—:', babelError);
                    document.getElementById('root').innerHTML = `
                        <div class="text-center">
                            <h1 class="text-2xl font-bold mb-4 text-red-600">âŒ Babel è½‰æ›å¤±æ•—</h1>
                            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                                <strong>éŒ¯èª¤:</strong> ${babelError.message}
                            </div>
                        </div>
                    `;
                }
            })
            .catch(error => {
                console.error('âŒ è¼‰å…¥å¤±æ•—:', error);
                document.getElementById('root').innerHTML = `
                    <div class="text-center">
                        <h1 class="text-2xl font-bold mb-4 text-red-600">âŒ è¼‰å…¥å¤±æ•—</h1>
                        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                            <strong>éŒ¯èª¤:</strong> ${error.message}
                        </div>
                    </div>
                `;
            });
    </script>
</body>
</html>
