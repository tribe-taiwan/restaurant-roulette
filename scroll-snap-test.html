<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ»‘å‹•å¸é™„æ¸¬è©¦</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        .section {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
        }
        
        .section-1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .slot-machine {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: 5px solid white;
            border-radius: 20px;
            position: relative;
        }
        
        .section-3 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .debug-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="debug-info" id="debug">ç­‰å¾…æ»‘å‹•...</div>
    
    <div class="section section-1">
        <div>ä¸Šæ–¹å€åŸŸ<br>å¿«é€Ÿå‘ä¸‹æ»‘å‹•æ¸¬è©¦</div>
    </div>
    
    <div class="section slot-machine" data-name="slot-machine">
        <div>ğŸ° è€è™æ©Ÿå€å¡Š<br>ç›®æ¨™å®šä½é»</div>
    </div>
    
    <div class="section section-3">
        <div>ä¸‹æ–¹å€åŸŸ<br>å¿«é€Ÿå‘ä¸Šæ»‘å‹•æ¸¬è©¦</div>
    </div>

    <script>
        // ç°¡åŒ–ç‰ˆæ»‘å‹•æª¢æ¸¬ - åŒæ™‚æ”¯æ´è§¸æ§å’Œæ»‘é¼ 
        class SimpleScrollSnap {
            constructor() {
                this.startY = null;
                this.startTime = null;
                this.isTracking = false;
                this.VELOCITY_THRESHOLD = 0.8; // é™ä½é–¾å€¼ä¾¿æ–¼æ¸¬è©¦
                this.MIN_DISTANCE = 50; // æœ€å°è·é›¢
                
                this.bindEvents();
                this.log('åˆå§‹åŒ–å®Œæˆ');
            }
            
            bindEvents() {
                // è§¸æ§äº‹ä»¶
                document.addEventListener('touchstart', (e) => this.onStart(e.touches[0].clientY), { passive: false });
                document.addEventListener('touchend', (e) => this.onEnd(e.changedTouches[0].clientY, e), { passive: false });
                
                // æ»‘é¼ äº‹ä»¶ (ç”¨æ–¼æ¸¬è©¦)
                document.addEventListener('mousedown', (e) => this.onStart(e.clientY), { passive: false });
                document.addEventListener('mouseup', (e) => this.onEnd(e.clientY, e), { passive: false });
            }
            
            onStart(y) {
                this.startY = y;
                this.startTime = Date.now();
                this.isTracking = true;
                this.log(`é–‹å§‹: Y=${this.startY}`);
            }
            
            onEnd(y, event) {
                if (!this.isTracking) return;
                
                const endY = y;
                const endTime = Date.now();
                
                const distance = Math.abs(endY - this.startY);
                const duration = endTime - this.startTime;
                const velocity = distance / duration;
                const direction = endY < this.startY ? 'ä¸Š' : 'ä¸‹';
                
                this.log(`æ»‘å‹•çµæŸ: è·é›¢=${distance}px, æ™‚é–“=${duration}ms, é€Ÿåº¦=${velocity.toFixed(2)}px/ms, æ–¹å‘=${direction}`);
                
                if (distance > this.MIN_DISTANCE && velocity > this.VELOCITY_THRESHOLD) {
                    this.log(`âœ… å¿«é€Ÿæ»‘å‹•æª¢æ¸¬æˆåŠŸï¼é˜»æ­¢åŸç”Ÿæ»¾å‹•ä¸¦å®šä½åˆ°è€è™æ©Ÿ`);
                    
                    // é˜»æ­¢åŸç”Ÿæ»¾å‹•
                    event.preventDefault();
                    event.stopPropagation();
                    
                    // å»¶é²ä¸€é»æ™‚é–“ç¢ºä¿é˜»æ­¢ç”Ÿæ•ˆ
                    setTimeout(() => {
                        this.snapToTarget();
                    }, 10);
                } else {
                    this.log('æ…¢é€Ÿæ»‘å‹•ï¼Œä¿æŒåŸç”Ÿè¡Œç‚º');
                }
                
                this.isTracking = false;
            }
            
            snapToTarget() {
                const target = document.querySelector('[data-name="slot-machine"]');
                if (!target) {
                    this.log('âŒ æ‰¾ä¸åˆ°ç›®æ¨™å…ƒç´ ');
                    return;
                }
                
                // åœæ­¢ä»»ä½•æ­£åœ¨é€²è¡Œçš„æ»¾å‹•
                document.body.style.overflow = 'hidden';
                setTimeout(() => {
                    document.body.style.overflow = '';
                }, 50);
                
                const rect = target.getBoundingClientRect();
                const targetTop = rect.top + window.pageYOffset;
                
                this.log(`ğŸ¯ å®šä½åˆ°è€è™æ©Ÿ: ${targetTop}px`);
                
                // ç«‹å³è·³è½‰åˆ°ç›®æ¨™ä½ç½®
                window.scrollTo({
                    top: targetTop,
                    behavior: 'smooth'
                });
                
                // ç¢ºèªæ»¾å‹•çµæœ
                setTimeout(() => {
                    const currentScroll = window.pageYOffset;
                    this.log(`æ»¾å‹•å®Œæˆ: ç•¶å‰ä½ç½®=${currentScroll}px`);
                }, 500);
            }
            
            log(message) {
                console.log(message);
                const debug = document.getElementById('debug');
                if (debug) {
                    debug.innerHTML = `${new Date().toLocaleTimeString()}: ${message}`;
                }
            }
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            window.scrollSnap = new SimpleScrollSnap();
        });
    </script>
</body>
</html>